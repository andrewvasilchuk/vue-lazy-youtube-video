!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VueLazyYoutubeVideo={},t.Vue)}(this,(function(t,e){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=i(e),a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var a in e=arguments[i])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function r(t,e,i){return void 0===i&&(i=0),t.indexOf(e,i)===i}function o(t){return/^\d+:\d+$/.test(t)}var s,c="16:9",u=["default","mqdefault","sddefault","hqdefault","maxresdefault"],l=u[4],d={allowfullscreen:!0,frameborder:0,allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"},p=/^https:\/\/www\.youtube(?:-nocookie)?\.com\/embed\/(.+?)(?:\?.*)?$/,h=/^https:\/\/www\.loom\.com\/embed\/(.+?)(?:\?.*)?$/;!function(t){t.LOAD_IFRAME="load:iframe",t.INIT_PLAYER="init:player"}(s||(s={}));var f=n.default.extend({name:"VueLazyYoutubeVideo",props:{src:{type:String,required:!0,validator:function(t){return r(t,"https://www.youtube.com/embed/")||r(t,"https://www.youtube-nocookie.com/embed/")||r(t,"https://www.loom.com/embed/")}},alt:{type:String,default:"Video thumbnail"},buttonLabel:{type:String,default:"Play video"},aspectRatio:{type:String,default:c,validator:o},previewImageSize:{type:String,default:l,validator:function(t){return-1!==u.indexOf(t)}},thumbnail:{type:Object,validator:function(t){return"jpg"in t&&"webp"in t}},iframeAttributes:{type:Object},webp:{type:Boolean,default:!0},autoplay:{type:Boolean,default:!1},thumbnailListeners:{type:Object},enablejsapi:{type:Boolean,default:!1},playerOptions:{type:Object,default:function(){return{}}},injectPlayerScript:{type:Boolean,default:!1},parameters:{type:Object,default:function(){return{}}}},data:function(){return{activated:this.autoplay,playerInstance:null,__interval__:null}},computed:{id:function(){var t=null;return null!==(t=r(this.src,"https://www.loom.com/embed/")?h.exec(this.src):p.exec(this.src))?t[1]:(this.warn("Failed to extract video id from ".concat(this.src)),"")},srcAttribute:function(){var t=-1!==this.src.indexOf("?"),e="".concat(this.src).concat(t?"&":"?","autoplay=1").concat(this.enablejsapi?"&enablejsapi=1":"");return Object.entries(this.parameters).reduce((function(t,e){var i=e[0],n=e[1];return t+"&".concat(i,"=").concat(n)}),e)},styleObj:function(){return{paddingBottom:this.getPaddingBottom()}}},methods:{clickHandler:function(){this.activated=!0},getPaddingBottom:function(){var t=this.aspectRatio,e="Invalid value ".concat(t," supplied to `aspectRatio` property, instead fallback value ").concat(c," is used ");("string"!=typeof t||"string"==typeof t&&!1===o(t))&&(t=c,this.warn(e));var i=t.split(":").map(Number),n=i[0],a=i[1];return this.getPaddingBottomValue(n,a)},getPaddingBottomValue:function(t,e){return"".concat(e/t*100,"%")},onIframeLoad:function(){if(this.$emit(s.LOAD_IFRAME,{iframe:this.$refs.iframe}),this.enablejsapi)try{window.YT.Player,this.initPlayerInstance()}catch(t){if(!this.injectPlayerScript)throw console.error("[vue-lazy-youtube-video]: window.YT.Player is not defined. Make sure you either included the IFrame Player API or passed `injectPlayerScript` prop"),t;this.doInjectPlayerScript()}},checkPlayer:function(){return!!YT.Player&&(this.__interval__&&clearInterval(this.__interval__),this.initPlayerInstance(),!0)},initPlayerInstance:function(){var t=this.$refs.iframe;if(!t)throw new Error("[vue-lazy-youtube-video]: YT.Player can not be instantiated without iframe element");return this.playerInstance=new YT.Player(t,this.playerOptions),this.$emit(s.INIT_PLAYER,{instance:this.playerInstance}),this.playerInstance},getPlayerInstance:function(){return this.playerInstance},doInjectPlayerScript:function(){var t=this,e=document.createElement("script");e.setAttribute("src","https://www.youtube.com/player_api"),e.onload=function(){t.__interval__=window.setInterval((function(){t.checkPlayer()}),32)},document.head.appendChild(e)},warn:function(t){console.warn("[vue-lazy-youtube-video]: ".concat(t))},renderIframe:function(t){return t("iframe",{ref:"iframe",staticClass:"y-video__media",attrs:a(a(a({},d),this.iframeAttributes),{src:this.srcAttribute}),on:{load:this.onIframeLoad}})},renderYoutubeThumbnail:function(t){return t("picture",{},[this.webp?t("source",{attrs:{srcset:this.thumbnail&&this.thumbnail.webp||"https://i.ytimg.com/vi_webp/".concat(this.id,"/").concat(this.previewImageSize,".webp"),type:"image/webp"}}):null,t("img",{staticClass:"y-video__media y-video__media--type--img",attrs:{src:this.thumbnail&&this.thumbnail.jpg||"https://i.ytimg.com/vi/".concat(this.id,"/").concat(this.previewImageSize,".jpg"),alt:this.alt},on:this.thumbnailListeners})])},renderLoomThumbnail:function(t){return t("picture",{},[t("img",{staticClass:"y-video__media y-video__media--type--img",attrs:{src:this.thumbnail&&this.thumbnail.jpg||"https://cdn.loom.com/sessions/thumbnails/".concat(this.id,"-00001.jpg"),alt:this.alt},on:this.thumbnailListeners})])},renderButtonIcon:function(t){return t("svg",{attrs:{viewBox:"0 0 68 48",width:"100%",height:"100%"}},[t("path",{staticClass:"y-video__button-shape",attrs:{d:"M66.5 7.7c-.8-2.9-2.5-5.4-5.4-6.2C55.8.1 34 0 34 0S12.2.1 6.9 1.6c-3 .7-4.6 3.2-5.4 6.1a89.6 89.6 0 0 0 0 32.5c.8 3 2.5 5.5 5.4 6.3C12.2 47.9 34 48 34 48s21.8-.1 27.1-1.6c3-.7 4.6-3.2 5.4-6.1C68 35 68 24 68 24s0-11-1.5-16.3z"}}),t("path",{staticClass:"y-video__button-icon",attrs:{d:"M45 24L27 14v20"}})])}},render:function(t){var e=this;return t("div",{staticClass:"y-video",on:{click:function(){return e.clickHandler()}}},[t("div",{staticClass:"y-video__inner",style:this.styleObj},[this.activated?this.renderIframe(t):[r(this.src,"https://www.loom.com/embed/")?this.renderLoomThumbnail(t):this.renderYoutubeThumbnail(t),this.$slots.button||t("button",{staticClass:"y-video__button",attrs:{type:"button","aria-label":this.buttonLabel}},[this.$slots.icon||this.renderButtonIcon(t)])]])])}}),m={install:function(t){t.component("LazyYoutubeVideo",f)}};t.Plugin=m,t.default=f,Object.defineProperty(t,"__esModule",{value:!0})}));
